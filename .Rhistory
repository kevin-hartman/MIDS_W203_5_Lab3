options(repr.plot.width=8, repr.plot.height=16)
grid.arrange(q1, q1a, q2, q2a, q3, q3a, ncol=2)
grid.arrange(q4, q4a, q5, q5a, q6, q6a, ncol=2)
grid.arrange(q7, q7a, q8, q8a, q9, q9a, ncol=2)
dfCrime$logwcon<-log(dfCrime$wcon)
dfCrime$logwtuc<-log(dfCrime$wtuc)
dfCrime$logwtrd<-log(dfCrime$wtrd)
dfCrime$logwfir<-log(dfCrime$wfir)
dfCrime$logwser<-log(dfCrime$wser)
dfCrime$logwmfg<-log(dfCrime$wmfg)
dfCrime$logwfed<-log(dfCrime$wfed)
dfCrime$logwsta<-log(dfCrime$wsta)
dfCrime$logwloc<-log(dfCrime$wloc)
#Plot of the criminal justice and law enforcment related variables vs crmrte
q1<-ggplot(data = dfCrime, aes(x = prbarr, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q1a<-ggplot(data = dfCrime, aes(x = log(prbarr), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q2<-ggplot(data = dfCrime, aes(x = prbconv, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q2a<-ggplot(data = dfCrime, aes(x = log(prbconv), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q3<-ggplot(data = dfCrime, aes(x = prbpris, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q3a<-ggplot(data = dfCrime, aes(x = log(prbpris), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q4<-ggplot(data = dfCrime, aes(x = avgsen, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q4a<-ggplot(data = dfCrime, aes(x = log(avgsen), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q5<-ggplot(data = dfCrime, aes(x = polpc, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q5a<-ggplot(data = dfCrime, aes(x = log(polpc), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q6<-ggplot(data = dfCrime, aes(x = mix, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q6a<-ggplot(data = dfCrime, aes(x = log(mix), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
grid.arrange(q1, q1a, q2, q2a, q3, q3a, ncol=2)
grid.arrange(q4, q4a, q5, q5a, q6, q6a, ncol=2)
dfCrime$logprbarr <- log(dfCrime$prbarr)
dfCrime$logprbconv <- log(dfCrime$prbconv)
dfCrime$logprbpris <- log(dfCrime$prbpris)
dfCrime$logavgsen <- log(dfCrime$avgsen)
dfCrime$logpolpc <- log(dfCrime$polpc)
dfCrime$logmix <- log(dfCrime$mix)
q1<-ggplot(data = dfCrime, aes(x = pctymle, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q1a<-ggplot(data = dfCrime, aes(x = log(pctymle), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q2<-ggplot(data = dfCrime, aes(x = pctmin80, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q2a<-ggplot(data = dfCrime, aes(x = log(pctmin80), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q3<-ggplot(data = dfCrime, aes(x = density, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q3a<-ggplot(data = dfCrime, aes(x = log(density), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
grid.arrange(q1, q1a, q2, q2a, q3, q3a, ncol=2)
dfCrime$logdensity <- log(dfCrime$density)
dfCrime$logpctmin80 <- log(dfCrime$pctmin80)
dfCrime$logpctymle <- log(dfCrime$pctymle)
q1<-ggplot(data = dfCrime, aes(x = taxpc, y = crmrte, color = region)) +
geom_point()+
geom_smooth(method = "lm")
q1a<-ggplot(data = dfCrime, aes(x = log(taxpc), y = log(crmrte), color = region)) +
geom_point()+
geom_smooth(method = "lm")
q2<-ggplot(data = dfCrime, aes(x = crmrte)) +
geom_histogram(bins=30)
q2a<-ggplot(data = dfCrime, aes(x = log(crmrte))) +
geom_histogram(bins=30)
grid.arrange(q1, q1a, q2, q2a, ncol=2)
dfCrime$logcrmrte = log(dfCrime$crmrte)
dfCrime$logtaxpc = log(dfCrime$taxpc)
options(repr.plot.width=8, repr.plot.height=8)
myData<-dfCrime
myData<-myData[, c("logcrmrte", "west", "central", "other", "urban", "logprbarr", "logprbconv", "logprbpris", "logavgsen", "logpolpc", "logtaxpc",
"logpctmin80", "logwcon", "logwtuc", "logwtrd", "logwfir", "logwser", "logwmfg", "logwfed", "logwsta", "logwloc",
"logmix", "logpctymle", "logdensity")]
plot<-myData %>% correlate() %>% network_plot(min_cor=.25)
grid.arrange(arrangeGrob(plot, bottom = 'Correlations Among Variables'),
top = "Network plot for Correlation Study", ncol=1)
dfCrime$allWages<-dfCrime$wcon + dfCrime$wtuc + dfCrime$wtrd + dfCrime$wfir +
dfCrime$wser + dfCrime$wmfg + dfCrime$wfed + dfCrime$wsta + dfCrime$wloc
dfCrime$crimJustEff<-dfCrime$prbarr * dfCrime$prbconv
dfCrime$logcrimJustEff<-log(dfCrime$crimJustEff)
options(repr.plot.width=3, repr.plot.height=4)
ggplot(data = dfCrime, aes(y = crmrte)) +
geom_boxplot()
options(repr.plot.width=4, repr.plot.height=4)
hist((dfCrime$prbconv))
hist((dfCrime$prbarr))
# how many standard deviations away the outlier lies
(dfCrime[51,]$prbarr - mean(dfCrime$prbarr))/sd(dfCrime$prbarr)
#hist(log(dfCrime$crimJustEff))
ggplot(data=dfCrime, aes(sample= crimJustEff)) + stat_qq() + stat_qq_line() +
ggtitle("QQ Plot of Crim Just Eff")
dfCrime[dfCrime$crimJustEff > 1,] # find outlier
dfCrime$prbarr[which(dfCrime$county==115)]<-NA # set the value to NA so it will be imputed
dfCrime$prbconv[which(dfCrime$county==115)]<-NA # set the value to NA so it will be imputed
dfCrime$polpc[which(dfCrime$county==115)]<-NA # set the value to NA so it will be imputed
impute_arg <- aregImpute(~ crmrte +  urban + central + west + other +
prbarr + prbconv + prbpris + avgsen + polpc +
density + taxpc + pctmin80 + wcon + wtuc +
wtrd + wfir + wser + wmfg + wfed + wsta + wloc +
mix + pctymle, data = dfCrime, match="weighted",
nk=3, B=10, n.impute = 100)
paste("R-squares for Predicting Non-Missing Values for Each Variable")
impute_arg$rsq
paste("Distribution of Values for Each Imputation")
table(impute_arg$imputed$prbarr)
paste("Distribution of Values for Each Imputation")
table(impute_arg$imputed$prbconv)
paste("Distribution of Values for Each Imputation")
table(impute_arg$imputed$polpc)
dfCrime$prbarr[which(dfCrime$county==115)]<-mean(impute_arg$imputed$prbarr)
dfCrime$prbarr[which(dfCrime$county==115)]
dfCrime$prbconv[which(dfCrime$county==115)]<-mean(impute_arg$imputed$prbconv)
dfCrime$prbconv[which(dfCrime$county==115)]
dfCrime$polpc[which(dfCrime$county==115)]<-mean(impute_arg$imputed$polpc)
dfCrime$polpc[which(dfCrime$county==115)]
dfCrime$logprbarr[which(dfCrime$county==115)]<-log(dfCrime$prbarr[which(dfCrime$county==115)])
dfCrime$logprbarr[which(dfCrime$county==115)]
dfCrime$logprbconv[which(dfCrime$county==115)]<-log(dfCrime$prbconv[which(dfCrime$county==115)])
dfCrime$logprbconv[which(dfCrime$county==115)]
dfCrime$logpolpc[which(dfCrime$county==115)]<-log(dfCrime$polpc[which(dfCrime$county==115)])
dfCrime$logpolpc[which(dfCrime$county==115)]
dfCrime$crimJustEff<-dfCrime$prbarr * dfCrime$prbconv
dfCrime$logcrimJustEff<-log(dfCrime$crimJustEff)
ggplot(data=dfCrime, aes(sample= crimJustEff)) + stat_qq() + stat_qq_line() +
ggtitle("QQ Plot of Crim Just Eff")
ggplot(data=dfCrime, aes(sample= logcrimJustEff)) + stat_qq() + stat_qq_line() +
ggtitle("QQ Plot of log transformed Crim Just Eff")
## Can show histogram/qqplot side by side in RMD.
# # Quantiles for all jobs
dfWage<-mutate(dfCrime,qCon=ntile(dfCrime$wcon,4))
dfWage<-mutate(dfWage,qTuc=ntile(dfCrime$wtuc,4))
dfWage<-mutate(dfWage,qTrd=ntile(dfCrime$wtrd,4))
dfWage<-mutate(dfWage,qFir=ntile(dfCrime$wfir,4))
dfWage<-mutate(dfWage,qSer=ntile(dfCrime$wser,4))
dfWage<-mutate(dfWage,qMfg=ntile(dfCrime$wmfg,4))
dfWage<-mutate(dfWage,qFed=ntile(dfCrime$wfed,4))
dfWage<-mutate(dfWage,qSta=ntile(dfCrime$wsta,4))
dfWage<-mutate(dfWage,qLoc=ntile(dfCrime$wloc,4))
## Average quantile
dfWage$qAvg= (dfWage$qCon+dfWage$qTuc+dfWage$qTrd+dfWage$qFir+dfWage$qSer+dfWage$qMfg+
dfWage$qFed+dfWage$qSta+dfWage$qLoc)/9
plot(dfCrime$allWages,dfWage$qAvg)
hist(dfCrime$allWages)
ggplot(data=dfCrime, aes(sample= allWages)) + stat_qq() + stat_qq_line() +
ggtitle("QQ Plot of sum of wages")
dfCrime$unweighted_avg_wage <- dfCrime$allWages/9
mod1 <- lm(dfCrime$logcrmrte ~ dfCrime$unweighted_avg_wage + dfCrime$logcrimJustEff)
coeftest(mod1, vcov=vcovHC)
vif(mod1)
summary(mod1)$adj.r.square
shapiro.test(mod1$residuals)
plot(mod1, which=5)
plot(mod1, which=2)
plot(mod1, which=3)
plot(mod1, which=1)
cov(resid(mod1), dfCrime$allWages)
cov(resid(mod1), log(dfCrime$crimJustEff))
mean(resid(mod1))
corrplot(cor(dfCrime[,c("logcrmrte", "logcrimJustEff", "logprbarr", "logprbconv",
"prbpris", "polpc", "taxpc", "allWages", "urban", "density",
"pctymle", "pctmin80")]),method='circle', type = 'lower')
# polpc transformation analysis
par(mfrow = c(2,2))
hist(dfCrime$polpc, main="Hist of polpc", breaks=50)
hist(dfCrime$logpolpc, main="Hist of logpolpc", breaks=50)
hist(1/dfCrime$polpc, main="Hist of Recip polpc", breaks=50)
hist(sqrt(dfCrime$polpc), main="Hist of Sqrt polpc", breaks=50)
# taxpc transformation analysis
par(mfrow = c(2,2))
hist(dfCrime$taxpc, main="Hist of taxpc", breaks=50)
hist(dfCrime$logtaxpc, main="Hist of logtaxpc",breaks=50)
hist(1/dfCrime$taxpc, main="Hist of Recip taxpc", breaks=50)
hist(sqrt(dfCrime$taxpc), main="Hist of Sqrt taxpc", breaks=50)
# density transformation analysis
par(mfrow = c(2,2))
hist(dfCrime$density, main="Hist of density", breaks=50)
hist(dfCrime$logdensity, main="Hist of logdensity",breaks=50)
hist(1/dfCrime$density, main="Hist of Recip density", breaks=50)
hist(sqrt(dfCrime$density), main="Hist of Sqrt density", breaks=50)
# par(mfrow = c(2,2))
# plot(dfCrime$logcrimJustEff, dfCrime$polpc, main = 'polpc vs logcrimJustEff', xlab='logcrimJustEff', ylab='polpc')
# plot(dfCrime$logcrimJustEff, dfCrime$logpolpc, main = 'logpolpc vs logcrimJustEff', xlab='logcrimJustEff', ylab='logpolpc')
# plot(dfCrime$logcrimJustEff, dfCrime$taxpc, main = 'taxpc vs logcrimJustEff', xlab='logcrimJustEff', ylab='taxpc')
# plot(dfCrime$logcrimJustEff, dfCrime$logtaxpc, main = 'logtaxpc vs logcrimJustEff', xlab='logcrimJustEff', ylab='logtaxpc')
model2 <- lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) + logtaxpc + sqrt(dfCrime$density), data = dfCrime)
model2
vif(model2)
plot(model2, which=1)
coeftest(model2, vcov=vcovHC)
plot(model2, which=2)
# hist(model2$residuals)
# shapiro.test(model2$residuals)
#null hypothesis: residuals drawn from population with a normal distribution.
#small p-value tells you if you can reject the null hypothesis.
#this test depends on sample size, it does not take very much deviation from normality for
#us to get a statistically significant result
summary(model2)
summary(dfCrime$pctmin80)
boxplot(dfCrime$pctmin80)
plot(dfCrime$pctmin80, dfCrime$logcrmrte)
abline(lm(dfCrime$logcrmrte~dfCrime$pctmin80))
plot(dfCrime$logpctmin80, dfCrime$logcrmrte)
abline(lm(dfCrime$logcrmrte~dfCrime$logpctmin80))
## Testing
##dfCrime <- dfCrime[dfCrime$county != 55,]
##dfCrime <- dfCrime[dfCrime$county != 115,]
dfCrime
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) + logtaxpc + density +
logpctmin80, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
vif(model3)
plot(model3, which = 1)
coeftest(model3, vcov=vcovHC)
hist(model3$residuals)
plot(model3)
stargazer(mod1,model2,model3,type="text")
options(repr.plot.width=8, repr.plot.height=4)
#myData<-myData[, c("crmrte", "prbarr", "prbconv", "prbpris", "avgsen", "polpc", "density", "taxpc",
#           "pctmin80", "wcon", "wtuc", "wtrd", "wfir", "wser", "wmfg", "wfed", "wsta", "wloc",
#           "mix", "pctymle")]
myData<-dfCrime %>% filter(other==1)
myData<-myData[, c("logcrmrte", "logprbarr", "logprbconv", "logprbpris", "logavgsen", "logpolpc", "logtaxpc",
"logpctmin80", "logwcon", "logwtuc", "logwtrd", "logwfir", "logwser", "logwmfg", "logwfed", "logwsta", "logwloc",
"logmix", "logpctymle")]
r0 <- myData %>% correlate() %>% network_plot(min_cor=.25)
myData<-dfCrime %>% filter(central==1)
myData<-myData[, c("logcrmrte", "logprbarr", "logprbconv", "logprbpris", "logavgsen", "logpolpc", "logtaxpc",
"logpctmin80", "logwcon", "logwtuc", "logwtrd", "logwfir", "logwser", "logwmfg", "logwfed", "logwsta", "logwloc",
"logmix", "logpctymle")]
r1 <- myData %>% correlate() %>% network_plot(min_cor=.25)
myData<-dfCrime %>% filter(west==1)
myData<-myData[, c("logcrmrte", "logprbarr", "logprbconv", "logprbpris", "logavgsen", "logpolpc", "logtaxpc",
"logpctmin80", "logwcon", "logwtuc", "logwtrd", "logwfir", "logwser", "logwmfg", "logwfed", "logwsta", "logwloc",
"logmix", "logpctymle")]
r2 <- myData %>% correlate() %>% network_plot(min_cor=.25)
grid.arrange(arrangeGrob(r1, bottom = 'Central Region Correlation Plot'), ncol=1)
grid.arrange(arrangeGrob(r2, bottom = 'Western Region Correlation Plot'), ncol=1)
grid.arrange(arrangeGrob(r0, bottom = 'Other Region Correlation Plot'), ncol=1)
myData<-dfCrime %>% filter(urban==0)
myData<-myData[, c("logcrmrte", "logprbarr", "logprbconv", "logprbpris", "logavgsen", "logpolpc", "logtaxpc",
"logpctmin80", "logwcon", "logwtuc", "logwtrd", "logwfir", "logwser", "logwmfg", "logwfed", "logwsta", "logwloc",
"logmix", "logpctymle")]
r0 <- myData %>% correlate() %>% network_plot(min_cor=.25)
myData<-dfCrime %>% filter(urban==1)
myData<-myData[, c("logcrmrte", "logprbarr", "logprbconv", "logprbpris", "logavgsen", "logpolpc",  "logtaxpc",
"logpctmin80", "logwcon", "logwtuc", "logwtrd", "logwfir", "logwser", "logwmfg", "logwfed", "logwsta", "logwloc",
"logmix", "logpctymle")]
r1 <- myData %>% correlate() %>% network_plot(min_cor=.25)
grid.arrange(arrangeGrob(r0, bottom = 'Non-Urban Correlation Plot'), ncol=1)
grid.arrange(arrangeGrob(r1, bottom = 'Urban Correlation Plot'), ncol=1)
corrplot(cor(dfCrime[,c("west", "central", "pctmin80")]),method='circle', type = 'lower')
ggplot(data = dfCrime, aes(x=region, y = pctmin80)) +
geom_boxplot()
ggplot(data = dfCrime, aes(y = pctmin80, color=regcode)) +
geom_boxplot()
ggplot(data = dfCrime, aes(y = pctmin80, color=regcode)) +
geom_boxplot()
ggplot(data = dfCrime, aes(y = pctmin80, color=regcode)) +
geom_boxplot() + main("Percentage of minorities in the County by Region")
ggplot(data = dfCrime, aes(y = pctmin80, color=regcode)) +
geom_boxplot() + ggtitle("Percentage of minorities in the County by Region")
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) + logtaxpc + density +
pctmin80, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) +  density +
pctmin80, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) +  density +
logpctmin80, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
summary(dfCrime$pctmin80)
boxplot(dfCrime$pctmin80)
hist(dfCrime$pctmin80)
plot(dfCrime$pctmin80, dfCrime$logcrmrte)
abline(lm(dfCrime$logcrmrte~dfCrime$pctmin80))
plot(dfCrime$logpctmin80, dfCrime$logcrmrte)
abline(lm(dfCrime$logcrmrte~dfCrime$logpctmin80))
hist(dfCrime$logpctmin80)
plot(dfCrime$pctmin80, dfCrime$logcrmrte)
abline(lm(dfCrime$logcrmrte~dfCrime$pctmin80))
plot(dfCrime$logpctmin80, dfCrime$logcrmrte)
abline(lm(dfCrime$logcrmrte~dfCrime$logpctmin80))
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) +  density +
logpctmin80*west + logpctmin80*central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) +  density +
logpctmin80*west, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) +  density +
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages) +  density + logpctmin80
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ crimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80*central
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80*region
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
summary(model3)
coeftest(model3, vcov = vcovHC)
plot(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
model3$adj.r.squared
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
summary(model3)$adj.r.square
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared",summary(model3)$adj.r.square)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared: ",summary(model3)$adj.r.square)
vif(model3)
coeftest(model3, vcov=vcovHC)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared: ",summary(model3)$adj.r.square)
linearHypothesis(model3,"west=0,central=0")
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared: ",summary(model3)$adj.r.square)
linearHypothesis(model3,"west=0,central=0", vcov=vcovHC)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared: ",summary(model3)$adj.r.square)
linearHypothesis(model3,c"west=0,central=0", vcov=vcovHC)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared: ",summary(model3)$adj.r.square)
linearHypothesis(model3,c("west=0,central=0"), vcov=vcovHC)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared: ",summary(model3)$adj.r.square)
linearHypothesis(model3,c("west=0","central=0"), vcov=vcovHC)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3
paste("Model 3 Adj. R squared: ",summary(model3)$adj.r.square)
linearHypothesis(model3,c("west=0","central=0","logpctmin80=0"), vcov=vcovHC)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3_initial
linearHypothesis(model3,c("west=0"), vcov=vcovHC)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3_initial
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3_initial
VIF(model3)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3_initial
vif(model3)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc
+ west + central, data = dfCrime)
model3_initial
linearHypothesis(model3_initial,c("west=0","central=0"), vcov=vcovHC)
linearHypothesis(model3_initial,c("west=0","central=0","logpctmin80=0"), vcov=vcovHC)
VIF(model3_initial)
linearHypothesis(model3_initial,c("west=0","central=0"), vcov=vcovHC)
linearHypothesis(model3_initial,c("west=0","central=0","logpctmin80=0"), vcov=vcovHC)
vif(model3_initial)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + west + central, data = dfCrime)
model3_initial
linearHypothesis(model3_initial,c("west=0","central=0"), vcov=vcovHC)
linearHypothesis(model3_initial,c("west=0","central=0","logpctmin80=0"), vcov=vcovHC)
vif(model3_initial)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80, data = dfCrime)
model3
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +   + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
vif(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
vif(model3)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + taxpc, data = dfCrime)
model3
summary(model3)$adj.r.square
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
plot(model3, which = 1)
coeftest(model3, vcov=vcovHC)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80 + west + central, data = dfCrime)
summary(model3_initial)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80*log(unweighted_avg_wage) + west + central, data = dfCrime)
summary(model3_initial)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(allWages/9) +  density + logpctmin80*unweighted_avg_wage + west + central, data = dfCrime)
summary(model3_initial)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + log(unweighted_avg_wage) +  density + logpctmin80*unweighted_avg_wage + west + central, data = dfCrime)
summary(model3_initial)
dfCrime$logunweightedavg<-log(dfCrime$unweighted_avg_wage)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + logunweightedavg +  density + logpctmin80*logunweightedavg + west + central, data = dfCrime)
summary(model3_initial)
dfCrime$logunweightedavg<-log(dfCrime$unweighted_avg_wage)
model3_initial<-lm(logcrmrte ~ logcrimJustEff + logpolpc + logunweightedavg +  density + logpctmin80 + west + central, data = dfCrime)
summary(model3_initial)
linearHypothesis(model3_initial,c("west=0","central=0"), vcov=vcovHC)
linearHypothesis(model3_initial,c("west=0","central=0","logpctmin80=0"), vcov=vcovHC)
vif(model3_initial)
linearHypothesis(model3_initial,c("west=0","central=0"), vcov=vcovHC)
linearHypothesis(model3_initial,c("west=0","central=0","logpctmin80=0"), vcov=vcovHC)
vif(model3_initial)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + logunweightedavg +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
vif(model3)
plot(model3, which = 1)
coeftest(model3, vcov=vcovHC)
hist(model3$residuals)
plot(model3,which=2)
plot(model3,which=5)
model3<-lm(logcrmrte ~ logcrimJustEff +  logunweightedavg +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + logunweightedavg +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
model3<-lm(logcrmrte ~ logcrimJustEff + polpc + logunweightedavg +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
coeftest(model3, vcov=vcovHC)
model3<-lm(logcrmrte ~ logcrimJustEff + logpolpc + logunweightedavg +  density + logpctmin80, data = dfCrime)
model3
summary(model3)$adj.r.square
coeftest(model3, vcov=vcovHC)
